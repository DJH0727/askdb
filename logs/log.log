[2025-09-02 16:36:49,349] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 16:37:06,109] INFO query.views: User input: 
[2025-09-02 16:37:06,110] INFO query.utils_db: Executing SQL: SELECT * FROM testuser LIMIT 5
[2025-09-02 16:37:06,112] INFO query.utils_db: Returned 3 rows
[2025-09-02 16:45:20,231] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 16:45:23,017] WARNING django.request: Not Found: /
[2025-09-02 16:45:23,285] WARNING django.request: Not Found: /favicon.ico
[2025-09-02 16:46:28,180] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\askdb\urls.py changed, reloading.
[2025-09-02 16:46:29,556] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 16:46:31,437] WARNING django.request: Not Found: /
[2025-09-02 16:46:38,304] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\askdb\urls.py changed, reloading.
[2025-09-02 16:46:39,710] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 16:50:18,966] WARNING django.request: Not Found: /favicon.ico
[2025-09-02 17:02:47,232] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:03:29,230] WARNING django.request: Not Found: /favicon.ico
[2025-09-02 17:07:00,421] WARNING django.request: Not Found: /getReply/
[2025-09-02 17:07:02,646] WARNING django.request: Not Found: /getReply/
[2025-09-02 17:08:21,494] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-02 17:08:22,700] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:08:37,063] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-02 17:08:38,338] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:08:56,848] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-02 17:08:58,159] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:09:04,953] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-02 17:09:06,215] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:09:27,900] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-02 17:09:29,080] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:09:53,996] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\askdb\urls.py changed, reloading.
[2025-09-02 17:09:55,154] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:14:15,119] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:14:19,565] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:14:26,185] WARNING django.request: Not Found: /favicon.ico
[2025-09-02 17:14:36,467] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:15:52,517] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:16:14,295] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:17:19,286] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-02 17:17:26,422] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:17:53,565] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:19:17,432] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:21:37,559] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:21:40,000] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:21:45,059] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:22:11,535] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:24:38,039] WARNING django.request: Not Found: /favicon.ico
[2025-09-02 17:24:41,401] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:26:55,305] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-02 17:27:58,787] WARNING django.request: Not Found: /.well-known/appspecific/com.chrome.devtools.json
[2025-09-03 13:33:14,061] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 13:39:16,154] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 13:39:17,604] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 13:39:28,365] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 13:39:29,816] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 13:39:53,020] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 13:39:54,356] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:09:58,870] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:10:18,582] INFO query.utils_db: Executing SQL: SELECT * FROM testuser LIMIT 5
[2025-09-03 14:10:18,586] INFO query.utils_db: Returned 3 rows
[2025-09-03 14:10:47,104] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:10:48,327] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:10:55,417] INFO query.utils_db: Executing SQL: SELECT * FROM testuser LIMIT 5
[2025-09-03 14:10:55,420] INFO query.utils_db: Returned 3 rows
[2025-09-03 14:10:55,514] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 22, in getReply
    response["reply"] = JsonResponse(result)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\http\response.py", line 744, in __init__
    raise TypeError(
TypeError: In order to allow non-dict objects to be serialized set the safe parameter to False.
[2025-09-03 14:11:27,215] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:11:28,454] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:11:35,847] INFO query.utils_db: Executing SQL: SELECT * FROM testuser LIMIT 5
[2025-09-03 14:11:35,849] INFO query.utils_db: Returned 3 rows
[2025-09-03 14:13:21,352] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:13:22,562] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:13:27,866] INFO query.utils_db: Executing SQL: SELECT * FROM testuser LIMIT 5
[2025-09-03 14:13:27,869] INFO query.utils_db: Returned 3 rows
[2025-09-03 14:14:13,876] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:14:15,075] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:14:18,410] WARNING query.utils_db: Blocked non-SELECT SQL: 111
[2025-09-03 14:14:18,434] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 20, in getReply
    result = run_sql(user_input)
  File "D:\Program\Python\scientificProject\askdb\query\utils_db.py", line 17, in run_sql
    raise ValueError("只允许执行 SELECT 查询！")
ValueError: 只允许执行 SELECT 查询！
[2025-09-03 14:17:38,897] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\query\utils_db.py changed, reloading.
[2025-09-03 14:17:40,050] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:17:51,622] WARNING query.utils_db: Blocked non-SELECT SQL: 11111111111
[2025-09-03 14:18:35,920] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\query\utils_db.py changed, reloading.
[2025-09-03 14:18:37,125] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:18:40,598] WARNING query.utils_db: Blocked non-SELECT SQL: 111
[2025-09-03 14:28:34,507] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:28:35,711] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:40:41,991] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:40:43,366] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:44:58,427] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:44:59,597] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:45:16,547] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\askdb\urls.py changed, reloading.
[2025-09-03 14:45:17,768] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:45:32,533] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 14:45:37,454] WARNING chat.utils_db: Blocked non-SELECT SQL: 你好
[2025-09-03 14:49:25,901] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:49:27,238] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:50:27,117] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:50:28,347] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:51:20,017] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:51:21,415] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:53:01,487] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 14:53:02,648] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 14:53:11,760] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 14:53:39,934] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 14:53:45,282] INFO chat.utils_db: Executing SQL: SELECT id, name, email, age FROM testuser
[2025-09-03 14:53:45,282] INFO chat.utils_db: Returned 3 rows
[2025-09-03 14:54:16,407] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 14:54:48,337] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 14:55:33,633] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 14:55:38,141] INFO chat.utils_db: Executing SQL: SELECT * FROM testuser WHERE id < 2
[2025-09-03 14:55:38,143] INFO chat.utils_db: Returned 1 rows
[2025-09-03 15:08:03,319] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 15:08:04,889] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:09:27,570] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 15:09:28,843] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:09:48,386] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:09:52,702] INFO chat.utils_db: Executing SQL: SELECT * FROM testuser;
[2025-09-03 15:09:52,702] INFO chat.utils_db: Returned 3 rows
[2025-09-03 15:11:53,416] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:11:57,726] INFO chat.utils_db: Executing SQL: SELECT * FROM testuser
[2025-09-03 15:11:57,726] INFO chat.utils_db: Returned 3 rows
[2025-09-03 15:12:31,869] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:12:36,855] INFO chat.utils_db: Executing SQL: SELECT id, name, email, age FROM testuser WHERE email IS NULL OR email = ''
[2025-09-03 15:12:36,858] INFO chat.utils_db: Returned 0 rows
[2025-09-03 15:12:49,305] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:12:55,781] INFO chat.utils_db: Executing SQL: SELECT id, name, email, age FROM testuser WHERE email IS NOT NULL AND email != '';
[2025-09-03 15:12:55,784] INFO chat.utils_db: Returned 3 rows
[2025-09-03 15:13:28,541] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:13:34,702] INFO chat.utils_db: Executing SQL: SELECT * FROM testuser WHERE age < 30
[2025-09-03 15:13:34,702] INFO chat.utils_db: Returned 2 rows
[2025-09-03 15:15:19,001] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:15:20,356] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:15:41,303] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:15:46,035] INFO chat.utils_db: Executing SQL: SELECT name, age FROM testuser WHERE age < 30
[2025-09-03 15:15:46,039] INFO chat.utils_db: Returned 2 rows
[2025-09-03 15:29:45,766] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 15:29:47,170] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:31:49,644] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 15:31:50,976] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:33:38,052] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:33:43,236] INFO chat.utils_db: Executing SQL: SELECT name, email FROM testuser WHERE email IS NOT NULL
[2025-09-03 15:33:43,242] INFO chat.utils_db: Returned 3 rows
[2025-09-03 15:33:43,419] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:36:19,277] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:36:20,618] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:36:34,715] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:36:36,118] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:36:42,508] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:36:43,809] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:37:29,979] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:37:31,390] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:37:42,224] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 15:37:43,460] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:38:11,473] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:38:16,229] INFO chat.utils_db: Executing SQL: SELECT name, email, age FROM testuser WHERE age < 30
[2025-09-03 15:38:16,229] INFO chat.utils_db: Returned 2 rows
[2025-09-03 15:38:16,352] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:38:58,949] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:39:03,947] INFO chat.utils_db: Executing SQL: SELECT name, email, age FROM testuser WHERE age < 30
[2025-09-03 15:39:03,949] INFO chat.utils_db: Returned 2 rows
[2025-09-03 15:39:04,037] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:39:50,493] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:39:51,797] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:39:58,846] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:40:04,899] INFO chat.utils_db: Executing SQL: SELECT name, email, age FROM testuser WHERE age < 30
[2025-09-03 15:40:04,902] INFO chat.utils_db: Returned 2 rows
[2025-09-03 15:40:04,986] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:40:39,733] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:40:41,011] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:41:16,496] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:41:17,803] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:41:29,510] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:41:35,866] INFO chat.utils_db: Executing SQL: SELECT name, email, age FROM testuser WHERE age < 30
[2025-09-03 15:41:35,868] INFO chat.utils_db: Returned 2 rows
[2025-09-03 15:41:35,969] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:44:26,626] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\constants.py changed, reloading.
[2025-09-03 15:44:28,078] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:45:39,788] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\constants.py changed, reloading.
[2025-09-03 15:45:41,132] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:45:45,290] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\constants.py changed, reloading.
[2025-09-03 15:45:46,611] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:46:48,684] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:46:49,988] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:47:12,772] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:47:19,659] INFO chat.utils_db: Executing SQL: SELECT sale_date, SUM(amount) AS daily_sales FROM sales WHERE sale_date >= '2025-08-27' AND sale_date <= '2025-09-03' GROUP BY sale_date ORDER BY sale_date
[2025-09-03 15:47:19,664] INFO chat.utils_db: Returned 3 rows
[2025-09-03 15:47:19,820] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:49:23,559] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 15:49:24,997] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:49:57,113] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-03 15:49:58,340] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:50:16,745] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_db.py changed, reloading.
[2025-09-03 15:50:18,006] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 15:50:26,096] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:50:32,127] INFO chat.utils_db: Executing SQL: SELECT sale_date, SUM(amount) AS daily_sales FROM sales WHERE sale_date >= '2025-08-27' AND sale_date <= '2025-09-03' GROUP BY sale_date ORDER BY sale_date
[2025-09-03 15:50:32,130] INFO chat.utils_db: Returned 3 rows
[2025-09-03 15:50:32,243] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:53:04,780] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:53:10,598] INFO chat.utils_db: Executing SQL: SELECT department, SUM(amount) AS total_sales FROM sales WHERE sale_date >= '2025-08-27' AND sale_date <= '2025-09-03' GROUP BY department
[2025-09-03 15:53:10,598] INFO chat.utils_db: Returned 2 rows
[2025-09-03 15:53:10,694] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:59:07,452] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 15:59:14,527] INFO chat.utils_db: Executing SQL: SELECT sale_date, SUM(amount) AS daily_sales FROM sales WHERE sale_date >= '2025-08-27' AND sale_date <= '2025-09-03' GROUP BY sale_date ORDER BY sale_date
[2025-09-03 15:59:14,531] INFO chat.utils_db: Returned 3 rows
[2025-09-03 15:59:14,609] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 16:01:07,672] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 16:01:13,723] INFO chat.utils_db: Executing SQL: SELECT sale_date, SUM(amount) AS daily_sales FROM sales WHERE sale_date >= '2025-08-27' AND sale_date <= '2025-09-03' GROUP BY sale_date ORDER BY sale_date
[2025-09-03 16:01:13,723] INFO chat.utils_db: Returned 3 rows
[2025-09-03 16:01:13,823] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 16:01:40,979] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 16:01:46,068] INFO chat.utils_db: Executing SQL: SELECT department, SUM(amount) AS total_sales FROM sales GROUP BY department
[2025-09-03 16:01:46,068] INFO chat.utils_db: Returned 2 rows
[2025-09-03 16:01:46,166] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 16:02:20,155] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 16:02:25,305] INFO chat.utils_db: Executing SQL: SELECT sale_date, amount FROM sales WHERE department = '技术部门' ORDER BY amount DESC LIMIT 1
[2025-09-03 16:02:25,308] INFO chat.utils_db: Returned 0 rows
[2025-09-03 16:04:32,065] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\constants.py changed, reloading.
[2025-09-03 16:04:33,423] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 16:04:43,236] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 16:04:48,331] INFO chat.utils_db: Executing SQL: SELECT sale_date, amount FROM sales WHERE department = '技术' ORDER BY amount DESC LIMIT 1
[2025-09-03 16:04:48,334] INFO chat.utils_db: Returned 1 rows
[2025-09-03 16:04:48,423] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:25:17,308] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 17:25:51,142] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:25:56,682] INFO chat.utils_db: Executing SQL: SELECT id, name FROM users WHERE email IS NULL OR email = ''
[2025-09-03 17:25:56,687] INFO chat.utils_db: Returned 4 rows
[2025-09-03 17:25:56,777] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:26:51,366] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:26:58,590] INFO chat.utils_db: Executing SQL: SELECT s.sale_date, SUM(s.amount) AS total_sales FROM sales s JOIN users u ON s.employee_id = u.id JOIN departments d ON u.department_id = d.id WHERE d.name = '技术' GROUP BY s.sale_date ORDER BY total_sales DESC LIMIT 1
[2025-09-03 17:26:58,602] INFO chat.utils_db: Returned 1 rows
[2025-09-03 17:26:58,695] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:28:25,999] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:28:33,688] INFO chat.utils_db: Executing SQL: SELECT d.name AS department_name, SUM(s.amount) AS total_sales, ROUND(SUM(s.amount) / (SELECT SUM(amount) FROM sales) * 100, 2) AS sales_percentage FROM sales s JOIN users u ON s.employee_id = u.id JOIN departments d ON u.department_id = d.id GROUP BY d.id, d.name ORDER BY total_sales DESC
[2025-09-03 17:28:33,688] INFO chat.utils_db: Returned 5 rows
[2025-09-03 17:28:33,782] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:29:22,842] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:29:29,763] INFO chat.utils_db: Executing SQL: SELECT COUNT(*) AS completed_tasks FROM tasks t JOIN users u ON t.employee_id = u.id WHERE u.name = 'Alice' AND t.status = 'completed' AND YEAR(t.task_date) = 2025 AND MONTH(t.task_date) = 9
[2025-09-03 17:29:29,776] ERROR chat.utils_db: SQL execution error: (1054, "Unknown column 't.task_date' in 'where clause'")
[2025-09-03 17:29:29,959] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.OperationalError: (1054, "Unknown column 't.task_date' in 'where clause'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.OperationalError: (1054, "Unknown column 't.task_date' in 'where clause'")
[2025-09-03 17:32:19,202] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-03 17:32:20,749] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-03 17:32:34,966] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:32:41,791] INFO chat.utils_db: Executing SQL: SELECT COUNT(*) AS completed_tasks FROM tasks t JOIN users u ON t.employee_id = u.id WHERE u.name = 'Alice' AND t.status = 'completed' AND YEAR(t.task_date) = 2025 AND MONTH(t.task_date) = 9
[2025-09-03 17:32:41,795] ERROR chat.utils_db: SQL execution error: (1054, "Unknown column 't.task_date' in 'where clause'")
[2025-09-03 17:32:41,833] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.OperationalError: (1054, "Unknown column 't.task_date' in 'where clause'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.OperationalError: (1054, "Unknown column 't.task_date' in 'where clause'")
[2025-09-03 17:33:45,972] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:33:52,369] INFO chat.utils_db: Executing SQL: SELECT u.name, SUM(s.amount) AS total_sales FROM sales s JOIN users u ON s.employee_id = u.id GROUP BY u.id, u.name ORDER BY total_sales DESC LIMIT 1
[2025-09-03 17:33:52,372] INFO chat.utils_db: Returned 1 rows
[2025-09-03 17:33:52,470] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:34:07,650] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:34:14,156] INFO chat.utils_db: Executing SQL: SELECT p.name AS project_name, s.amount AS revenue FROM sales s JOIN projects p ON s.project_id = p.id JOIN clients c ON s.client_id = c.id WHERE c.name = '客户A'
[2025-09-03 17:34:14,160] INFO chat.utils_db: Returned 4 rows
[2025-09-03 17:34:14,248] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:34:47,616] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:34:54,607] INFO chat.utils_db: Executing SQL: SELECT p.name AS project_name, p.budget, SUM(s.amount) AS actual_sales FROM projects p JOIN departments d ON p.department_id = d.id LEFT JOIN sales s ON p.id = s.project_id WHERE d.name = '技术' GROUP BY p.id, p.name, p.budget
[2025-09-03 17:34:54,611] INFO chat.utils_db: Returned 1 rows
[2025-09-03 17:34:54,687] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:36:11,114] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:36:17,113] INFO chat.utils_db: Executing SQL: SELECT p.name AS project_name, AVG(t.hours_spent) AS avg_hours FROM tasks t JOIN projects p ON t.project_id = p.id GROUP BY p.name
[2025-09-03 17:36:17,128] INFO chat.utils_db: Returned 5 rows
[2025-09-03 17:36:17,207] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:37:09,998] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:37:17,541] INFO chat.utils_db: Executing SQL: SELECT COUNT(*) AS completed_tasks FROM tasks t JOIN users u ON t.employee_id = u.id WHERE u.name = 'Alice' AND t.status = 'completed' AND EXTRACT(YEAR FROM t.task_date) = 2025 AND EXTRACT(MONTH FROM t.task_date) = 9
[2025-09-03 17:37:17,553] ERROR chat.utils_db: SQL execution error: (1054, "Unknown column 't.task_date' in 'where clause'")
[2025-09-03 17:37:17,579] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.OperationalError: (1054, "Unknown column 't.task_date' in 'where clause'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.OperationalError: (1054, "Unknown column 't.task_date' in 'where clause'")
[2025-09-03 17:45:13,228] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:45:18,109] INFO chat.utils_db: Executing SQL: SELECT id, name, email, department_id, hire_date, salary FROM users
[2025-09-03 17:45:18,109] INFO chat.utils_db: Returned 10 rows
[2025-09-03 17:45:18,192] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:46:20,051] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:46:24,892] INFO chat.utils_db: Executing SQL: SELECT id, name, department_id, start_date, end_date, budget FROM projects
[2025-09-03 17:46:24,894] INFO chat.utils_db: Returned 5 rows
[2025-09-03 17:46:24,994] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:47:13,485] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:47:19,082] INFO chat.utils_db: Executing SQL: SELECT name, budget FROM projects WHERE budget = (SELECT MAX(budget) FROM projects) OR budget = (SELECT MIN(budget) FROM projects) ORDER BY budget DESC
[2025-09-03 17:47:19,093] INFO chat.utils_db: Returned 2 rows
[2025-09-03 17:47:19,174] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:48:03,192] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:48:07,006] INFO chat.utils_db: Executing SQL: SELECT name, budget FROM projects ORDER BY budget DESC
[2025-09-03 17:48:07,006] INFO chat.utils_db: Returned 5 rows
[2025-09-03 17:48:07,108] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:48:39,904] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:48:44,860] INFO chat.utils_db: Executing SQL: SELECT id, name, department_id, start_date, end_date, budget FROM projects ORDER BY budget DESC
[2025-09-03 17:48:44,860] INFO chat.utils_db: Returned 5 rows
[2025-09-03 17:48:44,963] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:50:02,360] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:50:46,165] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-03 17:51:42,427] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:28:38,362] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 08:29:00,986] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:29:07,292] INFO chat.utils_db: Executing SQL: SELECT SUM(s.amount) AS total_sales FROM sales s JOIN users u ON s.employee_id = u.id WHERE u.name = 'Alice' AND s.sale_date >= '2025-09-01' AND s.sale_date <= '2025-09-30'
[2025-09-04 08:29:07,301] INFO chat.utils_db: Returned 1 rows
[2025-09-04 08:29:07,370] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:29:45,730] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:29:52,860] INFO chat.utils_db: Executing SQL: SELECT t.task_name, t.status, t.hours_spent, p.name AS project_name FROM tasks t INNER JOIN users u ON t.employee_id = u.id INNER JOIN projects p ON t.project_id = p.id WHERE u.name = 'Alice' AND t.status = 'completed' AND YEAR(t.task_name) = 2025 AND MONTH(t.task_name) = 9
[2025-09-04 08:29:52,865] INFO chat.utils_db: Returned 0 rows
[2025-09-04 08:31:03,153] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:31:10,105] INFO chat.utils_db: Executing SQL: SELECT t.task_name, t.status, t.hours_spent, p.name AS project_name FROM tasks t JOIN users u ON t.employee_id = u.id JOIN projects p ON t.project_id = p.id WHERE u.name = 'Alice' AND t.status = 'completed' AND YEAR(t.task_name) = 2025 AND MONTH(t.task_name) = 9
[2025-09-04 08:31:10,109] INFO chat.utils_db: Returned 0 rows
[2025-09-04 08:31:56,248] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:34:07,062] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 08:34:08,386] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 08:34:18,990] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:35:44,383] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:35:51,584] INFO chat.utils_db: Executing SQL: SELECT s.sale_date, u.name AS employee_name, c.name AS client_name, p.name AS project_name, s.amount FROM sales s JOIN users u ON s.employee_id = u.id JOIN clients c ON s.client_id = c.id JOIN projects p ON s.project_id = p.id WHERE s.sale_date >= '2025-08-28' AND s.sale_date <= '2025-09-04' ORDER BY s.sale_date DESC
[2025-09-04 08:35:51,589] INFO chat.utils_db: Returned 4 rows
[2025-09-04 08:35:51,658] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:37:33,291] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:37:37,511] INFO chat.utils_db: Executing SQL: SELECT id, sale_date, employee_id, client_id, project_id, amount FROM sales
[2025-09-04 08:37:37,511] INFO chat.utils_db: Returned 15 rows
[2025-09-04 08:37:37,592] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:39:08,490] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:39:14,719] INFO chat.utils_db: Executing SQL: SELECT s.sale_date, u.name AS employee_name, c.name AS client_name, p.name AS project_name, s.amount FROM sales s JOIN users u ON s.employee_id = u.id JOIN clients c ON s.client_id = c.id JOIN projects p ON s.project_id = p.id
[2025-09-04 08:39:14,735] INFO chat.utils_db: Returned 15 rows
[2025-09-04 08:39:14,801] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:41:38,702] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 08:41:42,047] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 08:42:01,462] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:42:07,254] INFO chat.utils_db: Executing SQL: SELECT s.sale_date, u.name AS employee_name, c.name AS client_name, p.name AS project_name, s.amount FROM sales s JOIN users u ON s.employee_id = u.id JOIN clients c ON s.client_id = c.id JOIN projects p ON s.project_id = p.id
[2025-09-04 08:42:07,258] INFO chat.utils_db: Returned 15 rows
[2025-09-04 08:42:07,331] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:43:15,196] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:43:20,908] INFO chat.utils_db: Executing SQL: SELECT sale_date, SUM(amount) AS total_sales FROM sales WHERE sale_date >= '2025-08-28' AND sale_date <= '2025-09-04' GROUP BY sale_date ORDER BY sale_date
[2025-09-04 08:43:20,908] INFO chat.utils_db: Returned 4 rows
[2025-09-04 08:43:20,984] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:48:25,303] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:48:50,460] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:48:54,662] INFO chat.utils_db: Executing SQL: SELECT name, department_id, hire_date, salary FROM users WHERE email IS NULL OR email = ''
[2025-09-04 08:48:54,662] INFO chat.utils_db: Returned 4 rows
[2025-09-04 08:48:54,726] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:49:39,400] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 08:49:42,214] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 08:49:53,276] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:49:57,101] INFO chat.utils_db: Executing SQL: SELECT name, department_id, hire_date, salary FROM users WHERE email IS NULL OR email = ''
[2025-09-04 08:49:57,101] INFO chat.utils_db: Returned 4 rows
[2025-09-04 08:49:57,191] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:50:30,106] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 08:50:31,407] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 08:51:02,241] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 08:51:03,534] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 08:51:12,843] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:52:08,149] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 08:52:09,387] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 08:52:23,504] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:52:27,998] INFO chat.utils_db: Executing SQL: SELECT name, department_id, hire_date, salary FROM users WHERE email IS NULL OR email = ''
[2025-09-04 08:52:27,998] INFO chat.utils_db: Returned 4 rows
[2025-09-04 08:52:28,078] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:53:11,251] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 08:53:15,564] INFO chat.utils_db: Executing SQL: SELECT name, hire_date FROM users WHERE salary < 6000
[2025-09-04 08:53:15,564] INFO chat.utils_db: Returned 2 rows
[2025-09-04 08:53:15,641] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:01:57,956] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:01:59,631] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:05:08,165] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:05:09,470] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:05:22,959] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:05:27,407] INFO chat.utils_db: Executing SQL: SELECT name, salary FROM users WHERE salary < 6000
[2025-09-04 09:05:27,412] INFO chat.utils_db: Returned 2 rows
[2025-09-04 09:05:27,491] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:05:42,943] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:05:47,347] INFO chat.utils_db: Executing SQL: SELECT name, salary FROM users WHERE salary < 6000
[2025-09-04 09:05:47,350] INFO chat.utils_db: Returned 2 rows
[2025-09-04 09:05:47,420] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:07:26,224] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:07:27,576] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:07:39,506] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:08:11,463] INFO chat.utils_db: Executing SQL: SELECT name FROM users WHERE salary <= 6000;
[2025-09-04 09:08:11,463] INFO chat.utils_db: Returned 3 rows
[2025-09-04 09:08:11,555] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:08:57,295] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:08:58,685] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:09:07,330] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:09:11,874] INFO chat.utils_db: Executing SQL: SELECT name, salary FROM users WHERE salary < 6000
[2025-09-04 09:09:11,874] INFO chat.utils_db: Returned 2 rows
[2025-09-04 09:09:11,951] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:11:18,537] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:11:19,935] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:14:24,639] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:14:56,118] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:14:57,403] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:15:04,533] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:15:55,649] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:15:57,008] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:16:04,363] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:16:05,604] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:16:10,013] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:16:24,256] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:16:28,270] INFO chat.utils_db: Executing SQL: SELECT name, salary FROM users WHERE salary < 6000
[2025-09-04 09:16:28,270] INFO chat.utils_db: Returned 2 rows
[2025-09-04 09:16:28,353] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:17:21,944] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:17:23,256] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:17:31,495] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:18:12,072] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:19:02,387] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:20:19,958] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:20:21,348] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:20:36,409] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:20:40,857] INFO chat.utils_db: Executing SQL: SELECT AVG(salary) AS average_salary FROM users
[2025-09-04 09:20:40,863] INFO chat.utils_db: Returned 1 rows
[2025-09-04 09:20:40,941] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:20:48,470] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:20:53,400] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users
[2025-09-04 09:20:53,405] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 09:20:53,550] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 09:23:36,707] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:23:38,027] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:23:57,260] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:24:02,312] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users
[2025-09-04 09:24:02,312] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 09:24:02,356] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 09:25:04,477] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:25:05,768] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:25:43,207] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:26:20,451] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:26:25,906] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY budget) AS median_budget FROM projects
[2025-09-04 09:26:25,908] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 09:26:25,949] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 09:27:15,204] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:27:16,689] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:27:23,513] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:27:28,416] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY budget) AS median_budget FROM projects
[2025-09-04 09:27:28,419] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 09:27:28,446] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 09:27:47,280] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:27:51,559] INFO chat.utils_db: Executing SQL: SELECT name, salary FROM users WHERE salary < 6000
[2025-09-04 09:27:51,561] INFO chat.utils_db: Returned 2 rows
[2025-09-04 09:27:51,654] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:28:21,700] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:28:27,498] INFO chat.utils_db: Executing SQL: SELECT u.name, u.salary FROM users u WHERE u.salary < (SELECT AVG(salary) FROM users)
[2025-09-04 09:28:27,498] INFO chat.utils_db: Returned 6 rows
[2025-09-04 09:28:27,579] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:28:47,180] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:28:52,376] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY budget) AS median_budget FROM projects
[2025-09-04 09:28:52,379] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 09:28:52,393] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 09:29:15,422] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:29:16,779] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:29:18,803] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:30:09,967] INFO chat.utils_db: Executing SQL: SELECT AVG(budget) AS median FROM (SELECT budget, ROW_NUMBER() OVER (ORDER BY budget) AS row_num, COUNT(*) OVER () AS total_count FROM projects) AS sub WHERE row_num IN (FLOOR((total_count + 1) / 2), CEIL((total_count + 1) / 2))
[2025-09-04 09:30:09,976] INFO chat.utils_db: Returned 1 rows
[2025-09-04 09:30:10,046] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:31:04,471] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:33:02,919] WARNING chat.utils_db: Blocked non-SELECT SQL: WITH ranked_salaries AS ( SELECT salary, ROW_NUMBER() OVER (ORDER BY salary) as row_num, COUNT(*) OVER () as total_count FROM users ) SELECT AVG(salary) as median_salary FROM ranked_salaries WHERE row_num IN (FLOOR((total_count + 1) / 2), CEIL((total_count + 1) / 2))
[2025-09-04 09:33:03,005] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:33:52,248] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:33:53,564] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:34:03,385] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:34:09,017] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 09:34:09,025] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:34:09,060] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:35:41,636] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:35:42,914] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:36:19,116] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:36:20,512] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:36:51,769] INFO httpx: HTTP Request: POST https://api.laozhang.ai/v1/chat/completions "HTTP/1.1 401 Unauthorized"
[2025-09-04 09:36:51,851] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 22, in getReply
    llm_response = generate_sql_from_nl(user_input, TABLE_SCHEMA)
  File "D:\Program\Python\scientificProject\askdb\chat\utils_llm.py", line 39, in generate_sql_from_nl
    response = client.chat.completions.create(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\resources\chat\completions\completions.py", line 1147, in create
    return self._post(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': '[qUUM06aGftDv1gKf2TBY4AjfwfIlCxkm3yYPqh5HHYSUGls9]无效的令牌 (request id: 202509040936515159962182237117)', 'type': 'shell_api_error'}}
[2025-09-04 09:37:49,121] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:37:50,428] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:38:01,794] INFO httpx: HTTP Request: POST https://api.laozhang.ai/v1/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:38:01,799] INFO chat.utils_db: Executing SQL: SELECT AVG(salary) AS median_salary FROM (SELECT salary FROM users ORDER BY salary LIMIT 2 - (SELECT COUNT(*) FROM users) % 2 OFFSET (SELECT (COUNT(*) - 1) / 2 FROM users)) AS median_subquery;
[2025-09-04 09:38:01,799] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '- (SELECT COUNT(*) FROM users) % 2 OFFSET (SELECT (COUNT(*) - 1) / 2 FROM users)' at line 1")
[2025-09-04 09:38:01,830] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '- (SELECT COUNT(*) FROM users) % 2 OFFSET (SELECT (COUNT(*) - 1) / 2 FROM users)' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '- (SELECT COUNT(*) FROM users) % 2 OFFSET (SELECT (COUNT(*) - 1) / 2 FROM users)' at line 1")
[2025-09-04 09:40:14,299] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:40:15,643] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:40:24,527] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:40:30,141] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1;
[2025-09-04 09:40:30,144] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:40:30,171] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:40:56,997] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:40:58,426] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:41:04,715] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:41:10,427] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_DISC(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users
[2025-09-04 09:41:10,430] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 09:41:10,459] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 09:41:35,156] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:41:36,577] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:43:20,488] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:43:21,861] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:43:31,900] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:43:38,561] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 09:43:38,563] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:43:38,592] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:44:07,440] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:44:09,090] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:44:45,285] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:44:51,621] INFO chat.utils_db: Executing SQL: SELECT AVG(salary) AS average_salary, MAX(salary) AS max_salary, MIN(salary) AS min_salary FROM users
[2025-09-04 09:44:51,621] INFO chat.utils_db: Returned 1 rows
[2025-09-04 09:44:51,701] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:45:09,972] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:45:17,857] INFO chat.utils_db: Executing SQL: SELECT CASE WHEN COUNT(*) % 2 = 0 THEN (SELECT AVG(salary) FROM (SELECT salary FROM users ORDER BY salary LIMIT (COUNT(*) / 2) - 1, 2) AS median_sub) ELSE (SELECT salary FROM users ORDER BY salary LIMIT (COUNT(*) / 2), 1) END AS median_salary FROM users
[2025-09-04 09:45:17,859] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(COUNT(*) / 2) - 1, 2) AS median_sub) ELSE (SELECT salary FROM users ORDER BY sa' at line 1")
[2025-09-04 09:45:17,896] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(COUNT(*) / 2) - 1, 2) AS median_sub) ELSE (SELECT salary FROM users ORDER BY sa' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(COUNT(*) / 2) - 1, 2) AS median_sub) ELSE (SELECT salary FROM users ORDER BY sa' at line 1")
[2025-09-04 09:46:04,437] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:46:05,805] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:46:39,383] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:46:40,654] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:46:50,773] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:46:56,593] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 09:46:56,596] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:46:56,624] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:47:29,885] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:47:31,244] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:47:37,042] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:47:43,567] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 09:47:43,570] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:47:43,602] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:49:41,547] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:49:42,880] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:50:23,155] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:50:29,064] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 09:50:29,066] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:50:29,093] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:50:38,893] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:50:40,341] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:50:44,489] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:50:50,979] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 09:50:50,981] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:50:51,011] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:51:02,531] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:51:03,886] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:51:09,974] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:51:16,642] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1;
[2025-09-04 09:51:16,645] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:51:16,674] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 09:51:48,446] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:51:49,845] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:53:06,071] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:53:07,865] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:53:36,713] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:53:37,972] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:53:56,130] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:54:00,683] INFO chat.utils_db: Executing SQL: SELECT name, salary FROM users ORDER BY salary
[2025-09-04 09:54:00,683] INFO chat.utils_db: Returned 10 rows
[2025-09-04 09:54:00,765] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:54:57,486] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:54:58,825] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:55:39,588] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:55:40,840] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:55:45,983] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 09:55:56,121] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users;
[2025-09-04 09:55:56,123] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users' at line 1")
[2025-09-04 09:55:56,153] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users' at line 1")
[2025-09-04 09:59:25,972] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 09:59:27,336] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 09:59:39,028] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:00:26,633] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 10:00:27,991] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 10:00:36,650] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:03:31,517] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 10:03:32,795] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 10:03:47,470] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:05:09,528] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 10:05:10,810] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 10:05:22,791] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:05:32,279] INFO chat.utils_db: Executing SQL: SELECT u.id, u.name, u.email, d.name AS department_name, u.hire_date, u.salary FROM users u JOIN departments d ON u.department_id = d.id
[2025-09-04 10:05:32,279] INFO chat.utils_db: Returned 10 rows
[2025-09-04 10:05:32,373] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:06:05,775] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:06:12,773] INFO chat.utils_db: Executing SQL: SELECT AVG(salary) AS average_salary FROM users;
[2025-09-04 10:06:12,775] INFO chat.utils_db: Returned 1 rows
[2025-09-04 10:06:12,877] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:06:49,105] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:06:59,495] INFO chat.utils_db: Executing SQL: SELECT u.name AS employee_name, u.salary, d.name AS department_name FROM users u JOIN departments d ON u.department_id = d.id WHERE u.salary > (SELECT AVG(salary) FROM users)
[2025-09-04 10:06:59,497] INFO chat.utils_db: Returned 4 rows
[2025-09-04 10:06:59,593] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:08:07,003] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:08:16,666] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users
[2025-09-04 10:08:16,668] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users' at line 1")
[2025-09-04 10:08:16,699] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users' at line 1")
[2025-09-04 10:11:07,595] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 10:11:08,923] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 10:11:20,811] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:11:28,842] INFO chat.utils_db: Executing SQL: SELECT u.name AS employee_name, u.salary FROM users u ORDER BY u.salary
[2025-09-04 10:11:28,845] INFO chat.utils_db: Returned 10 rows
[2025-09-04 10:11:28,925] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:24:55,574] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:26:27,876] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 10:26:29,261] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 10:26:35,187] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:26:42,891] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY budget) AS median_budget FROM projects
[2025-09-04 10:26:42,894] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 10:26:42,929] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 24, in getReply
    result = run_sql(llm_response.get("sql"))
  File "D:\Program\Python\scientificProject\askdb\chat\utils_db.py", line 22, in run_sql
    cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\db\backends\mysql\base.py", line 76, in execute
    return self.cursor.execute(query, args)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\cursors.py", line 330, in _query
    db.query(q)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\MySQLdb\connections.py", line 280, in query
    _mysql.connection.query(self, query)
django.db.utils.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 10:32:02,223] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_db.py changed, reloading.
[2025-09-04 10:32:03,576] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 10:32:11,306] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 10:32:19,480] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY budget) AS median_budget FROM projects
[2025-09-04 10:32:19,483] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY budget) AS median_budget FROM projects' at line 1")
[2025-09-04 19:14:06,016] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:15:05,553] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:15:13,975] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users
[2025-09-04 19:15:13,989] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 19:15:14,061] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:16:26,498] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-04 19:16:28,249] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:16:50,273] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-04 19:16:51,836] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:16:57,175] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:17:06,891] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1;
[2025-09-04 19:17:06,895] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 19:17:06,976] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:18:03,989] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\views.py changed, reloading.
[2025-09-04 19:18:06,428] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:18:33,929] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:18:35,405] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:18:44,801] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:18:53,130] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users
[2025-09-04 19:18:53,134] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 19:18:53,215] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:19:07,679] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:19:09,151] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:19:21,975] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:19:30,278] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 19:19:30,282] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 19:19:30,573] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:20:11,653] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:20:13,136] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:20:21,635] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:20:28,832] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1;
[2025-09-04 19:20:28,836] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 19:20:28,923] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:21:38,312] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:21:39,692] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:21:58,714] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:22:05,631] INFO chat.utils_db: Executing SQL: SELECT AVG(salary) AS average_salary FROM users;
[2025-09-04 19:22:05,649] INFO chat.utils_db: Returned 1 rows
[2025-09-04 19:22:05,737] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:22:17,990] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:22:25,476] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users
[2025-09-04 19:22:25,478] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 19:22:25,592] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:22:59,178] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:23:00,617] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:23:13,626] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:23:20,515] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users;
[2025-09-04 19:23:20,520] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 19:23:20,605] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:23:49,995] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:23:51,405] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:23:57,080] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:24:04,668] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1;
[2025-09-04 19:24:04,672] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 19:24:04,750] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:24:42,403] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:24:43,746] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:25:10,815] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:25:19,664] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) AS median_salary FROM users;
[2025-09-04 19:25:19,667] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) AS median_salary FROM users' at line 1")
[2025-09-04 19:25:19,740] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:36:21,739] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\utils_llm.py changed, reloading.
[2025-09-04 19:36:23,647] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:38:38,910] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\prompt.py changed, reloading.
[2025-09-04 19:38:40,427] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:38:48,635] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:38:54,945] INFO chat.utils_db: Executing SQL: SELECT name, salary FROM users WHERE salary > 10000
[2025-09-04 19:38:54,961] INFO chat.utils_db: Returned 0 rows
[2025-09-04 19:39:38,722] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:39:46,448] INFO chat.utils_db: Executing SQL: SELECT AVG(salary) AS average_salary, MAX(salary) AS max_salary, MIN(salary) AS min_salary FROM users
[2025-09-04 19:39:46,460] INFO chat.utils_db: Returned 1 rows
[2025-09-04 19:39:46,691] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 422 Unprocessable Entity"
[2025-09-04 19:39:46,839] ERROR django.request: Internal Server Error: /getReply/
Traceback (most recent call last):
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\Program\Python\scientificProject\askdb\chat\views.py", line 27, in getReply
    llm_summary = generate_chart_and_summary(result['data'],user_input)
  File "D:\Program\Python\scientificProject\askdb\chat\utils_llm.py", line 76, in generate_chart_and_summary
    result = call_llm_json(prompt, role)
  File "D:\Program\Python\scientificProject\askdb\chat\utils_llm.py", line 12, in call_llm_json
    response = client.chat.completions.create(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\_utils\_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\resources\chat\completions\completions.py", line 1147, in create
    return self._post(
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "D:\Program\Python\scientificProject\askdb\.venv\lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.UnprocessableEntityError: Failed to deserialize the JSON body into the target type: messages[1]: data did not match any variant of untagged enum ChatCompletionRequestContent at line 1 column 105
[2025-09-04 19:42:04,102] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\prompt.py changed, reloading.
[2025-09-04 19:42:05,580] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:42:12,547] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:42:20,763] INFO chat.utils_db: Executing SQL: SELECT AVG(salary) AS average_salary, MAX(salary) AS max_salary, MIN(salary) AS min_salary FROM users
[2025-09-04 19:42:20,763] INFO chat.utils_db: Returned 1 rows
[2025-09-04 19:42:20,853] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:43:11,861] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:43:20,941] INFO chat.utils_db: Executing SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1
[2025-09-04 19:43:20,944] ERROR chat.utils_db: SQL execution error: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(ORDER BY salary) OVER () AS median_salary FROM users LIMIT 1' at line 1")
[2025-09-04 19:43:21,032] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:43:32,016] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:43:42,271] INFO chat.utils_db: Executing SQL: SELECT CASE WHEN salary < 5000 THEN '低工资' WHEN salary BETWEEN 5000 AND 10000 THEN '中等工资' ELSE '高工资' END AS salary_range, COUNT(*) AS employee_count FROM users GROUP BY salary_range ORDER BY employee_count DESC
[2025-09-04 19:43:42,287] INFO chat.utils_db: Returned 1 rows
[2025-09-04 19:43:42,376] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:45:04,942] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:46:24,858] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\prompt.py changed, reloading.
[2025-09-04 19:46:26,477] INFO django.utils.autoreload: Watching for file changes with StatReloader
[2025-09-04 19:46:35,263] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:46:46,403] INFO chat.utils_db: Executing SQL: SELECT CASE WHEN salary < 5000 THEN '0-5000' WHEN salary < 10000 THEN '5000-10000' WHEN salary < 15000 THEN '10000-15000' WHEN salary < 20000 THEN '15000-20000' ELSE '20000+' END AS salary_range, COUNT(*) AS employee_count FROM users GROUP BY salary_range ORDER BY MIN(salary)
[2025-09-04 19:46:46,416] INFO chat.utils_db: Returned 1 rows
[2025-09-04 19:46:46,514] INFO httpx: HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
[2025-09-04 19:49:21,157] INFO django.utils.autoreload: D:\Program\Python\scientificProject\askdb\chat\prompt.py changed, reloading.
[2025-09-04 19:49:22,766] INFO django.utils.autoreload: Watching for file changes with StatReloader
